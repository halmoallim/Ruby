# Super class (StoreItem)
class StoreItem
    # Define the setter and & getter
    attr_accessor :title , :price

    # Class constructor
    def initialize(t,pr)
      @title = t
      @price = pr
    end
end


# Books class 
class Book < StoreItem
    # Define the setter and & getter
    attr_accessor :author_name , :option_of_pages , :isbn

    # Class constructor
    def initialize(t,pr,a,np,i)
        super(t,pr)
      @author_name = a
      @option_of_pages = np
      @isbn = i
    end
end


# Magazine class 
class Magazine < StoreItem
    # Define the setter and & getter
    attr_accessor :publisher_agent , :date

    # Class constructor
    def initialize(t,pr,pa,d)
        super(t,pr)

      @publisher_agent = pa
      @date = d
    end
end





puts "Please enter a number betwwen [1-7] to start, or -1 to exit"

puts option1 = "1. Add store item"
puts option2 = "2. List most expensive items"
puts option3 = "3. List books within certain items"
puts option4 = "4. Search magazine by date"
puts option5 = "5. Search magazine by publisher"
puts option6 = "6. List of all store items"
puts option7 = "7. Delete an item"



option = gets.chomp.to_i
while (option!=-1)
  if (option == -1)
    break

    elsif (option == 1)

      puts "1.Book or 2.Magazine"
      catagory = gets.chomp.to_i
      if (catagory == 1)
      puts "Enter the title"
      book_title = gets.chomp
      puts "Enter the price"
      book_price = gets.chomp.to_i
      puts "Enter the author name"
      book_author = gets.chomp
      puts "Enter the how many pages"
      book_pages = gets.chomp.to_i
      puts "Enter the isbn"
      book_isbn= gets.chomp.to_i
      book_item = Book.new("#{book_title}","#{book_price}", "#{book_author}","#{book_pages}","#{book_isbn}")
      File.open("/Users/blackroyal/Documents/GitHub/Ruby/Book Store/Book.txt","a") do |file|
        file.write("\n#{book_title}, #{book_price}, #{book_author}, #{book_pages}, #{book_isbn}")
      end
      puts "the new book added is:"
      p book_item
      elsif (catagory == 2)
      puts "Enter the title"
      magazine_title = gets.chomp
      puts "Enter the price"
      magazine_price = gets.chomp.to_i
      puts "Enter the publisher-agent"
      magazine_publisher_agent = gets.chomp
      puts "Enter the date"
      magazine_date = gets.chomp
      magazine_item = Magazine.new("#{magazine_title}","#{magazine_price}", "#{magazine_publisher_agent}","#{magazine_date}")
      File.open("/Users/blackroyal/Documents/GitHub/Ruby/Book Store/Magazine.txt","a") do |file|
        file.write("\n#{magazine_title}, #{magazine_price}, #{magazine_publisher_agent}, #{magazine_date}")
      end
      puts "the new magazine added is:"
      p magazine_item
      end


    elsif(option == 2)

      puts "Most expensive books:"
      book_data = File.open("/Users/blackroyal/Documents/GitHub/Ruby/Book Store/Book.txt","r") 
      puts book_data.sort_by {|price| price[2]}


    elsif(option == 3)
      puts "not implemented yet"
    elsif(option == 4)

      puts "Enter the Magazine date in this format '2-12-2014'to filter the result:"
      date = gets.chomp
      magazine_data = File.open("/Users/blackroyal/Documents/GitHub/Ruby/Book Store/Magazine.txt","r") do |f|

      f.each_line do |line|
        if line =~ /#{date}/
          puts "Founded: #{line}"
        else
          break
        end
      end
    end

    elsif(option == 5)

      puts "Enter the publisher name"
      publisher = gets.chomp
      magazine_data = File.open("/Users/blackroyal/Documents/GitHub/Ruby/Book Store/Magazine.txt","r") do |f|

      f.each_line do |line|
        if line =~ /#{publisher}/
          puts "Founded: #{line}"
        end
      end
    end
      

    elsif(option == 6)

      puts "Books:"
      book_data = File.open("/Users/blackroyal/Documents/GitHub/Ruby/Book Store/Book.txt","r") 
      puts book_data.read

      puts "Magazine:"
      magazine_data = File.open("/Users/blackroyal/Documents/GitHub/Ruby/Book Store/Magazine.txt","r") 
      puts magazine_data.read

    elsif(option == 7)

        puts "1.Book or 2.Magazine"
      catagory = gets.chomp.to_i
      if (catagory == 1)
        puts "Enter the title to delete it:"
        delete_item = gets.chomp
        read_file = File.new('/Users/blackroyal/Documents/GitHub/Ruby/Book Store/Book.txt', "r").read
        write_file = File.new('/Users/blackroyal/Documents/GitHub/Ruby/Book Store/Book.txt', "w")

        read_file.each_line do |line|
        write_file.write(line) unless line.include? "#{delete_item}"
      end
      
    end
    
      

  end

puts "Please enter a number betwwen [1-7] to start again"
option = gets.to_i

end

puts "We are out"




